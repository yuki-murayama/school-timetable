# School Timetable Monorepo - é–‹ç™ºç’°å¢ƒã‚¬ã‚¤ãƒ‰

## Claudeã¸ã®ãŠé¡˜ã„

- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›ã™ã‚‹èª¬æ˜ã¯æ—¥æœ¬èªã§ãŠé¡˜ã„ã—ã¾ã™ã€‚

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

å­¦æ ¡æ™‚é–“å‰²ç®¡ç†ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¢ãƒãƒ¬ãƒæ§‹æˆ

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: React + TypeScript + Vite + Clerkèªè¨¼
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Hono + Cloudflare Workers + D1 Database
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: çµ±ä¸€ã•ã‚ŒãŸCloudflare Workersãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

## ğŸŒ ç’°å¢ƒæƒ…å ±

### ğŸ”— URL

- **æœ¬ç•ªç’°å¢ƒ**: https://school-timetable-monorepo.grundhunter.workers.dev
- **Clerkèªè¨¼**: https://equal-yeti-47.clerk.accounts.dev

### ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

- **D1 Database**: `school-timetable-db2`
- **Database ID**: `474551c0-3503-4adb-8eb5-71c4fcf42219`

### ğŸ” èªè¨¼æƒ…å ± (ãƒ†ã‚¹ãƒˆç”¨)

- **ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼**: .env.e2eã‚’å‚ç…§
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: .env.e2eã‚’å‚ç…§
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: `.env.e2e`

## ğŸ“¦ ä¸»è¦ãªã‚³ãƒãƒ³ãƒ‰

### ğŸš€ é–‹ç™ºãƒ»ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# å…¨ä½“ã®é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿
npm run dev:frontend

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿ (Wrangler dev)
npm run dev:backend

# ãƒ“ãƒ«ãƒ‰
npm run build

# ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy
```

### ğŸ§ª ãƒ†ã‚¹ãƒˆé–¢é€£

```bash
# E2Eãƒ†ã‚¹ãƒˆ (å…¨ä½“)
npm run test:e2e

# èªè¨¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿
npm run test:e2e:auth

# CRUDæ“ä½œãƒ†ã‚¹ãƒˆ
npm run test:e2e:crud

# å­¦æ ¡è¨­å®šã®ã¿ãƒ†ã‚¹ãƒˆ
npm run test:e2e:school

# UIä»˜ããƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:e2e:ui

# ãƒ†ã‚¹ãƒˆçµæœãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
npm run test:e2e:report

# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
npm test
```

### ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ– (APIçµŒç”±)
curl -X POST https://school-timetable-monorepo.grundhunter.workers.dev/api/init-db

# Drizzle Studio (ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºæ™‚)
npm run db:studio

# ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆ
npm run db:generate

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
npm run db:push
```

### ğŸ“Š ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«

```bash
# ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
npm run lint

# ã‚³ãƒ¼ãƒ‰è‡ªå‹•ä¿®æ­£
npm run lint:fix

# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
npm run format

# Wrangler tail (ãƒ­ã‚°ç¢ºèª)
npx wrangler tail --format pretty

# å‹ç”Ÿæˆ
npm run cf-typegen
```

## ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```text
src/
â”œâ”€â”€ frontend/          # React ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ components/    # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ lib/          # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¨API
â”‚   â””â”€â”€ hooks/        # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”œâ”€â”€ backend/          # Honoãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ routes/       # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ services/     # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â””â”€â”€ types/        # å‹å®šç¾©
â”œâ”€â”€ shared/           # å…±æœ‰ã®å‹å®šç¾©
â””â”€â”€ worker.ts         # Workersã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ

tests/
â””â”€â”€ e2e/             # E2Eãƒ†ã‚¹ãƒˆ
    â”œâ”€â”€ auth.setup.ts         # èªè¨¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    â”œâ”€â”€ authenticated-crud.spec.ts  # CRUDæ“ä½œãƒ†ã‚¹ãƒˆ
    â””â”€â”€ utils/        # ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
```

## ğŸ”§ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### é‡è¦ãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

- `wrangler.toml` - Cloudflare Workersè¨­å®š
- `playwright.config.ts` - E2Eãƒ†ã‚¹ãƒˆè¨­å®š
- `.env.e2e` - E2Eãƒ†ã‚¹ãƒˆç’°å¢ƒå¤‰æ•°
- `vite.frontend.config.ts` - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰è¨­å®š
- `vite.backend.config.ts` - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰è¨­å®š

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„

```bash
# è§£æ±º: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ã‚’å®Ÿè¡Œ
curl -X POST https://school-timetable-monorepo.grundhunter.workers.dev/api/init-db
```

#### 2. E2Eãƒ†ã‚¹ãƒˆã§èªè¨¼ã«å¤±æ•—

```bash
# è§£æ±º: èªè¨¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å˜ç‹¬ã§å®Ÿè¡Œ
npm run test:e2e:auth
```

#### 3. ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¨ãƒ©ãƒ¼

```bash
# è§£æ±º: æ˜ç¤ºçš„ã«wrangler.tomlã‚’æŒ‡å®š
npx wrangler deploy --config ./wrangler.toml
```

#### 4. ä¾å­˜é–¢ä¿‚ã®å•é¡Œ

```bash
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules package-lock.json
npm install
```

## ğŸ“ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ä¸»è¦ãªAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

- `GET /api/frontend/school/settings` - å­¦æ ¡è¨­å®šå–å¾—
- `PUT /api/frontend/school/settings` - å­¦æ ¡è¨­å®šæ›´æ–°
- `GET /api/frontend/school/teachers` - æ•™å¸«ä¸€è¦§å–å¾—
- `POST /api/frontend/school/teachers` - æ•™å¸«è¿½åŠ 
- `GET /api/frontend/school/subjects` - æ•™ç§‘ä¸€è¦§å–å¾—
- `POST /api/frontend/school/subjects` - æ•™ç§‘è¿½åŠ 
- `GET /api/frontend/school/classrooms` - æ•™å®¤ä¸€è¦§å–å¾—
- `POST /api/frontend/school/classrooms` - æ•™å®¤è¿½åŠ 
- `POST /api/init-db` - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–

## ğŸ¯ æœ€è¿‘ã®å¤‰æ›´ãƒ»ä¿®æ­£äº‹é …

### âœ… å®Œäº†ã—ãŸä¿®æ­£

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å•é¡Œ**: `school_settings`ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã¨åˆæœŸåŒ–
2. **APIä¿®æ­£**: å­¦æ ¡è¨­å®šæ›´æ–°ã®500ã‚¨ãƒ©ãƒ¼è§£æ±º
3. **E2Eèªè¨¼**: Clerkèªè¨¼ãƒ•ãƒ­ãƒ¼ã®è‡ªå‹•åŒ–å®Ÿè£…
4. **CRUDæ“ä½œ**: ãƒ‡ãƒ¼ã‚¿ç™»éŒ²ç”»é¢ã®èª­ã¿å–ã‚Šãƒ»æ›´æ–°æ©Ÿèƒ½ç¢ºèª

### ğŸ”„ é€²è¡Œä¸­/ä»Šå¾Œã®äºˆå®š

1. ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã§ã‚¯ãƒªãƒƒã‚¯ã§ããªã„å•é¡Œã®ä¿®æ­£
2. æ•™å¸«ãƒ»æ•™ç§‘ãƒ»æ•™å®¤ã® CRUDæ“ä½œå®Œå…¨ãƒ†ã‚¹ãƒˆ
3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

## ğŸ’¡ é–‹ç™ºã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **ã‚³ãƒŸãƒƒãƒˆå‰**: `npm run lint:fix` ã§ã‚³ãƒ¼ãƒ‰å“è³ªã‚’ç¢ºèª
2. **ãƒ‡ãƒ—ãƒ­ã‚¤å‰**: `npm run test:e2e` ã§E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
3. **APIå¤‰æ›´å¾Œ**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹
4. **èªè¨¼ãƒ†ã‚¹ãƒˆ**: `.env.e2e`ã®èªè¨¼æƒ…å ±ã‚’æœ€æ–°ã«ä¿ã¤
